<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="refresh" content="0; url=/zapisy/">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tomasz Nied藕wiecki | Inwestuj w ambitnych</title>

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=AW-17886093904"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'AW-17886093904');
    </script>

    <!-- Meta Pixel Code -->
    <script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window, document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '1571065357430677');
    fbq('track', 'PageView');
    </script>
    <noscript><img height="1" width="1" style="display:none"
    src="https://www.facebook.com/tr?id=1571065357430677&ev=PageView&noscript=1"
    /></noscript>
    <!-- End Meta Pixel Code -->

    <!-- TikTok Pixel Code -->
    <script>
    !function (w, d, t) {
      w.TiktokAnalyticsObject=t;var ttq=w[t]=w[t]||[];ttq.methods=["page","track","identify","instances","debug","on","off","once","ready","alias","group","enableCookie","disableCookie","holdConsent","revokeConsent","grantConsent"],ttq.setAndDefer=function(t,e){t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}};for(var i=0;i<ttq.methods.length;i++)ttq.setAndDefer(ttq,ttq.methods[i]);ttq.instance=function(t){for(
      var e=ttq._i[t]||[],n=0;n<ttq.methods.length;n++)ttq.setAndDefer(e,ttq.methods[n]);return e},ttq.load=function(e,n){var r="https://analytics.tiktok.com/i18n/pixel/events.js",o=n&&n.partner;ttq._i=ttq._i||{},ttq._i[e]=[],ttq._i[e]._u=r,ttq._t=ttq._t||{},ttq._t[e]=+new Date,ttq._o=ttq._o||{},ttq._o[e]=n||{};n=document.createElement("script")
      ;n.type="text/javascript",n.async=!0,n.src=r+"?sdkid="+e+"&lib="+t;e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(n,e)};
      ttq.load('D5MHQD3C77UALNU7I240');
      ttq.page();
    }(window, document, 'ttq');
    </script>
    <!-- End TikTok Pixel Code -->

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    animation: {
                        'pulse-glow': 'pulse-glow 2s ease-in-out infinite',
                    },
                    keyframes: {
                        'pulse-glow': {
                            '0%, 100%': { opacity: '0.3' },
                            '50%': { opacity: '0.5' },
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body {
            background-color: #09090b;
        }
        .avatar-glow {
            box-shadow: 0 0 20px rgba(168, 85, 247, 0.4), 0 0 40px rgba(168, 85, 247, 0.2);
        }

        /* Flowing wave gradient border */
        .gradient-border {
            padding: 2px;
            border-radius: 1rem;
            background: linear-gradient(
                90deg,
                #9333ea,
                #ec4899,
                #f97316,
                #ec4899,
                #9333ea
            );
            background-size: 200% 100%;
            animation: flow-wave 4s ease-in-out infinite;
        }
        .gradient-border-inner {
            background: #18181b;
            border-radius: calc(1rem - 2px);
        }
        @keyframes flow-wave {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        /* Autofill styles */
        input:-webkit-autofill,
        input:-webkit-autofill:hover,
        input:-webkit-autofill:focus {
            -webkit-text-fill-color: white;
            -webkit-box-shadow: 0 0 0px 1000px #18181b inset;
            transition: background-color 5000s ease-in-out 0s;
        }

        /* Success checkmark animation */
        .success-icon {
            animation: pop-in 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }
        .success-checkmark {
            stroke-dasharray: 30;
            stroke-dashoffset: 30;
            animation: draw-check 0.4s ease-out 0.3s forwards;
        }
        @keyframes pop-in {
            0% { transform: scale(0); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
        @keyframes draw-check {
            to { stroke-dashoffset: 0; }
        }

        /* Chat bubble animation */
        .chat-bubble {
            opacity: 0;
            transform: translateY(10px);
            animation: bubble-in 0.3s ease-out forwards;
        }
        @keyframes bubble-in {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .chat-bubble:nth-child(1) { animation-delay: 0.1s; }
        .chat-bubble:nth-child(2) { animation-delay: 0.35s; }
        .chat-bubble:nth-child(3) { animation-delay: 0.6s; }
        .chat-bubble:nth-child(4) { animation-delay: 0.85s; }

        .chat-cta {
            opacity: 0;
            transform: translateY(10px);
            animation: bubble-in 0.3s ease-out 1.1s forwards;
        }
    </style>
</head>
<body class="text-white min-h-screen">

    <!-- Main Chat Section -->
    <main id="chat-section" class="min-h-screen flex items-center justify-center px-4 sm:px-6 py-8 sm:py-20">
        <div class="w-full max-w-md">
            <!-- Header with avatar, glow, and online indicator -->
            <div class="text-center mb-4 sm:mb-6">
                <div class="relative inline-block">
                    <img src="https://www.tomekniedzwiecki.pl/photos/old_tomek_cale.jpg" alt="Tomasz" class="w-16 h-16 rounded-full object-cover object-top avatar-glow">
                    <!-- Green online dot -->
                    <div class="absolute bottom-0 right-0 w-4 h-4 bg-green-500 rounded-full border-2 border-zinc-950"></div>
                </div>
                <div class="text-white font-semibold mt-2">Tomasz Nied藕wiecki</div>
                <div class="text-zinc-500 text-xs">Tw贸rca TakeDrop</div>
            </div>

            <!-- Chat bubbles -->
            <div class="space-y-1.5 sm:space-y-2 mb-4 sm:mb-6">
                <!-- Message 1 -->
                <div class="flex justify-start chat-bubble">
                    <div>
                        <div class="bg-zinc-700 rounded-2xl rounded-bl-sm px-4 py-2 max-w-[80%]">
                            <p class="text-white text-[15px]">Hej!  Zbudowaem firm wycenion na <span class="font-semibold">25 mln z</span> i sprzedaem udziay.</p>
                        </div>
                        <div class="text-zinc-600 text-[11px] mt-1 ml-2 hidden min-[400px]:block" id="time1"></div>
                    </div>
                </div>
                <!-- Message 2 -->
                <div class="flex justify-start chat-bubble">
                    <div>
                        <div class="bg-zinc-700 rounded-2xl rounded-bl-sm px-4 py-2 max-w-[80%]">
                            <p class="text-white text-[15px]">Teraz zainwestuj w par os贸b, kt贸rym zbuduj biznes online - sklep lub aplikacj.</p>
                        </div>
                        <div class="text-zinc-600 text-[11px] mt-1 ml-2 hidden min-[400px]:block" id="time2"></div>
                    </div>
                </div>
                <!-- User message -->
                <div class="flex flex-col items-end chat-bubble">
                    <div class="bg-gradient-to-r from-purple-600 via-pink-500 to-orange-400 rounded-2xl rounded-br-sm px-4 py-2">
                        <p class="text-white text-[15px]">Jakie s warunki i jak si zgosi?</p>
                    </div>
                    <div class="text-zinc-600 text-[11px] mt-1 mr-2 flex items-center gap-1">
                        <span>Przeczytano</span>
                        <span id="time3"></span>
                    </div>
                </div>
                <!-- Message 3 -->
                <div class="flex justify-start chat-bubble">
                    <div>
                        <div class="bg-zinc-700 rounded-2xl rounded-bl-sm px-4 py-2 max-w-[80%]">
                            <p class="text-white text-[15px]">Zostaw maila, przel na niego par pyta </p>
                        </div>
                        <div class="text-zinc-600 text-[11px] mt-1 ml-2" id="time4"></div>
                    </div>
                </div>
            </div>

            <!-- Email CTA: Animated gradient border -->
            <div class="gradient-border chat-cta">
                <form id="email-form" class="gradient-border-inner p-1.5 flex items-center gap-1.5">
                    <input
                        type="email"
                        id="email-input"
                        placeholder="Tw贸j najlepszy e-mail"
                        class="flex-1 px-4 py-3 bg-transparent text-white placeholder-zinc-500 text-[15px] focus:outline-none min-w-0"
                        required
                    >
                    <button type="submit" class="px-5 py-2.5 bg-white text-zinc-900 rounded-xl font-semibold text-[15px] hover:bg-zinc-100 transition-colors flex-shrink-0">
                        Wylij
                    </button>
                </form>
            </div>

            <!-- Legal links -->
            <p class="text-zinc-600 text-[11px] text-center mt-3 chat-cta">
                Wysyajc akceptujesz <a href="#" class="underline hover:text-zinc-400">regulamin</a> i <a href="#" class="underline hover:text-zinc-400">polityk prywatnoci</a>
            </p>
        </div>
    </main>

    <!-- Thank You Section (hidden by default) -->
    <main id="thankyou-section" class="min-h-screen flex items-center justify-center px-4 sm:px-6 py-20 hidden">
        <div class="w-full max-w-md text-center">
            <!-- Success icon -->
            <div class="mb-6">
                <div class="w-20 h-20 mx-auto bg-gradient-to-r from-purple-600 via-pink-500 to-orange-400 rounded-full flex items-center justify-center success-icon">
                    <svg class="w-10 h-10 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5">
                        <path class="success-checkmark" stroke-linecap="round" stroke-linejoin="round" d="M5 13l4 4L19 7" />
                    </svg>
                </div>
            </div>

            <!-- Thank you message -->
            <h1 class="text-2xl font-bold text-white mb-2">Dziki!</h1>
            <p class="text-zinc-400 mb-8">Za chwil dostaniesz ode mnie wiadomo i zaczniemy rozmowy <span class="text-white font-medium">o inwestycji w Ciebie</span>.</p>

            <!-- Countdown -->
            <div id="countdown-container" class="mb-6">
                <p class="text-zinc-500 text-sm mb-2">Wysyam wiadomo...</p>
                <span id="countdown" class="text-4xl font-bold bg-gradient-to-r from-purple-600 via-pink-500 to-orange-400 bg-clip-text text-transparent">5</span>
            </div>

            <!-- Email provider CTA (hidden initially) -->
            <a id="provider-link" href="#" target="_blank" class="hidden items-center gap-3 px-6 py-3.5 bg-gradient-to-r from-purple-600 via-pink-500 to-orange-400 text-white rounded-lg font-semibold text-[15px] hover:opacity-90 transition-opacity mb-6">
                <span id="provider-name">Otw贸rz poczt</span>
                <svg class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
                </svg>
            </a>

            <!-- Fallback for unknown providers (hidden initially) -->
            <p id="provider-fallback" class="text-zinc-300 text-sm mb-6 hidden">Otw贸rz swoj skrzynk pocztow</p>

            <!-- Reminder -->
            <p class="text-zinc-500 text-xs">Sprawd藕 te偶 folder SPAM lub Oferty</p>
        </div>
    </main>

    <script>
        // Email providers configuration
        const emailProviders = {
            // Polish providers
            'wp.pl': { name: 'WP Poczta', url: 'https://poczta.wp.pl' },
            'onet.pl': { name: 'Onet Poczta', url: 'https://poczta.onet.pl' },
            'onet.eu': { name: 'Onet Poczta', url: 'https://poczta.onet.pl' },
            'o2.pl': { name: 'O2 Poczta', url: 'https://poczta.o2.pl' },
            'interia.pl': { name: 'Interia Poczta', url: 'https://poczta.interia.pl' },
            'interia.eu': { name: 'Interia Poczta', url: 'https://poczta.interia.pl' },
            'tlen.pl': { name: 'Onet Poczta', url: 'https://poczta.onet.pl' },
            'gazeta.pl': { name: 'Gazeta Poczta', url: 'https://poczta.gazeta.pl' },
            'op.pl': { name: 'Onet Poczta', url: 'https://poczta.onet.pl' },
            'poczta.fm': { name: 'Interia Poczta', url: 'https://poczta.interia.pl' },
            'vp.pl': { name: 'Wirtualna Polska', url: 'https://poczta.wp.pl' },
            'buziaczek.pl': { name: 'Onet Poczta', url: 'https://poczta.onet.pl' },
            'autograf.pl': { name: 'Onet Poczta', url: 'https://poczta.onet.pl' },
            'spoko.pl': { name: 'Onet Poczta', url: 'https://poczta.onet.pl' },
            'poczta.onet.pl': { name: 'Onet Poczta', url: 'https://poczta.onet.pl' },

            // Google
            'gmail.com': { name: 'Gmail', url: 'https://mail.google.com' },
            'googlemail.com': { name: 'Gmail', url: 'https://mail.google.com' },

            // Microsoft
            'outlook.com': { name: 'Outlook', url: 'https://outlook.live.com' },
            'outlook.pl': { name: 'Outlook', url: 'https://outlook.live.com' },
            'hotmail.com': { name: 'Outlook', url: 'https://outlook.live.com' },
            'hotmail.pl': { name: 'Outlook', url: 'https://outlook.live.com' },
            'hotmail.co.uk': { name: 'Outlook', url: 'https://outlook.live.com' },
            'hotmail.fr': { name: 'Outlook', url: 'https://outlook.live.com' },
            'hotmail.de': { name: 'Outlook', url: 'https://outlook.live.com' },
            'live.com': { name: 'Outlook', url: 'https://outlook.live.com' },
            'live.pl': { name: 'Outlook', url: 'https://outlook.live.com' },
            'msn.com': { name: 'Outlook', url: 'https://outlook.live.com' },

            // Yahoo
            'yahoo.com': { name: 'Yahoo Mail', url: 'https://mail.yahoo.com' },
            'yahoo.pl': { name: 'Yahoo Mail', url: 'https://mail.yahoo.com' },
            'yahoo.co.uk': { name: 'Yahoo Mail', url: 'https://mail.yahoo.com' },
            'yahoo.de': { name: 'Yahoo Mail', url: 'https://mail.yahoo.com' },
            'yahoo.fr': { name: 'Yahoo Mail', url: 'https://mail.yahoo.com' },
            'ymail.com': { name: 'Yahoo Mail', url: 'https://mail.yahoo.com' },
            'rocketmail.com': { name: 'Yahoo Mail', url: 'https://mail.yahoo.com' },

            // Apple
            'icloud.com': { name: 'iCloud Mail', url: 'https://www.icloud.com/mail' },
            'me.com': { name: 'iCloud Mail', url: 'https://www.icloud.com/mail' },
            'mac.com': { name: 'iCloud Mail', url: 'https://www.icloud.com/mail' },

            // Proton
            'protonmail.com': { name: 'Proton Mail', url: 'https://mail.proton.me' },
            'protonmail.ch': { name: 'Proton Mail', url: 'https://mail.proton.me' },
            'proton.me': { name: 'Proton Mail', url: 'https://mail.proton.me' },
            'pm.me': { name: 'Proton Mail', url: 'https://mail.proton.me' },

            // German providers
            'gmx.de': { name: 'GMX', url: 'https://www.gmx.net' },
            'gmx.net': { name: 'GMX', url: 'https://www.gmx.net' },
            'gmx.at': { name: 'GMX', url: 'https://www.gmx.net' },
            'gmx.ch': { name: 'GMX', url: 'https://www.gmx.net' },
            'web.de': { name: 'WEB.DE', url: 'https://web.de' },
            't-online.de': { name: 'T-Online', url: 'https://email.t-online.de' },
            'freenet.de': { name: 'Freenet', url: 'https://email.freenet.de' },

            // French providers
            'orange.fr': { name: 'Orange', url: 'https://messagerie.orange.fr' },
            'wanadoo.fr': { name: 'Orange', url: 'https://messagerie.orange.fr' },
            'free.fr': { name: 'Free', url: 'https://webmail.free.fr' },
            'laposte.net': { name: 'La Poste', url: 'https://www.laposte.net' },
            'sfr.fr': { name: 'SFR', url: 'https://webmail.sfr.fr' },

            // UK providers
            'btinternet.com': { name: 'BT Mail', url: 'https://www.bt.com/email' },
            'sky.com': { name: 'Sky', url: 'https://www.sky.com/signin/email' },
            'virginmedia.com': { name: 'Virgin Media', url: 'https://www.virginmedia.com/email' },
            'talktalk.net': { name: 'TalkTalk', url: 'https://www.talktalk.co.uk/mail' },

            // Other international
            'mail.com': { name: 'Mail.com', url: 'https://www.mail.com' },
            'email.com': { name: 'Mail.com', url: 'https://www.mail.com' },
            'fastmail.com': { name: 'Fastmail', url: 'https://www.fastmail.com' },
            'fastmail.fm': { name: 'Fastmail', url: 'https://www.fastmail.com' },
            'tutanota.com': { name: 'Tutanota', url: 'https://mail.tutanota.com' },
            'tutamail.com': { name: 'Tutanota', url: 'https://mail.tutanota.com' },
            'tuta.io': { name: 'Tutanota', url: 'https://mail.tutanota.com' },
            'zoho.com': { name: 'Zoho Mail', url: 'https://mail.zoho.com' },
            'zoho.eu': { name: 'Zoho Mail', url: 'https://mail.zoho.eu' },
            'aol.com': { name: 'AOL Mail', url: 'https://mail.aol.com' },
            'yandex.com': { name: 'Yandex Mail', url: 'https://mail.yandex.com' },
            'yandex.ru': { name: 'Yandex Mail', url: 'https://mail.yandex.com' },
            'ya.ru': { name: 'Yandex Mail', url: 'https://mail.yandex.com' },
            'mail.ru': { name: 'Mail.ru', url: 'https://e.mail.ru' },
            'inbox.ru': { name: 'Mail.ru', url: 'https://e.mail.ru' },
            'list.ru': { name: 'Mail.ru', url: 'https://e.mail.ru' },
            'bk.ru': { name: 'Mail.ru', url: 'https://e.mail.ru' },
            'seznam.cz': { name: 'Seznam', url: 'https://email.seznam.cz' },
            'hey.com': { name: 'HEY', url: 'https://app.hey.com' },
            'inbox.com': { name: 'Inbox.com', url: 'https://www.inbox.com' },
            'gmx.com': { name: 'GMX', url: 'https://www.gmx.com' },
            'usa.com': { name: 'Mail.com', url: 'https://www.mail.com' },
            'myself.com': { name: 'Mail.com', url: 'https://www.mail.com' },
            'consultant.com': { name: 'Mail.com', url: 'https://www.mail.com' },
            'post.com': { name: 'Mail.com', url: 'https://www.mail.com' },
            'europe.com': { name: 'Mail.com', url: 'https://www.mail.com' },
            'asia.com': { name: 'Mail.com', url: 'https://www.mail.com' },
        };

        // Get email domain
        function getEmailDomain(email) {
            const parts = email.split('@');
            return parts.length === 2 ? parts[1].toLowerCase() : null;
        }

        // Get provider info
        function getProviderInfo(domain) {
            return emailProviders[domain] || null;
        }

        // Set current time for messages
        function updateTimes() {
            const now = new Date();

            const setTime = (id, minOffset) => {
                const d = new Date(now.getTime() - minOffset * 60000);
                const h = d.getHours().toString().padStart(2, '0');
                const m = d.getMinutes().toString().padStart(2, '0');
                document.getElementById(id).textContent = `${h}:${m}`;
            };

            setTime('time1', 3);
            setTime('time2', 2);
            setTime('time3', 1);
            setTime('time4', 0);
        }

        // Countdown function
        function startCountdown(provider) {
            const countdownEl = document.getElementById('countdown');
            const countdownContainer = document.getElementById('countdown-container');
            const providerLink = document.getElementById('provider-link');
            const providerName = document.getElementById('provider-name');
            const providerFallback = document.getElementById('provider-fallback');

            let count = 5;

            const interval = setInterval(() => {
                count--;
                if (count > 0) {
                    countdownEl.textContent = count;
                } else {
                    clearInterval(interval);
                    // Hide countdown, show button
                    countdownContainer.classList.add('hidden');

                    if (provider) {
                        providerName.textContent = `Otw贸rz ${provider.name}`;
                        providerLink.href = provider.url;
                        providerLink.classList.remove('hidden');
                        providerLink.classList.add('inline-flex');
                    } else {
                        providerFallback.classList.remove('hidden');
                    }
                }
            }, 1000);
        }

        // Supabase configuration
        const SUPABASE_URL = 'https://yxmavwkwnfuphjqbelws.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inl4bWF2d2t3bmZ1cGhqcWJlbHdzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njg3NjQyNTUsImV4cCI6MjA4NDM0MDI1NX0.XeR0Fc7OFn6YbNJrOKTBEj36JtmLISZTM87y4ai9340';
        const supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // Lista parametr贸w do zbierania
        const TRACKING_PARAMS = [
            // Click IDs
            'gclid', 'gbraid', 'wbraid', 'gad_source', 'fbclid', 'ttclid',
            // UTM
            'utm_source', 'utm_medium', 'utm_campaign', 'utm_content', 'utm_term', 'utm_id',
            // Google Ads
            'campaignid', 'adgroupid', 'creative', 'keyword', 'matchtype', 'device', 'network', 'placement', 'loc_physical_ms',
            // Meta
            'fb_campaign_id', 'fb_adset_id', 'fb_ad_id',
            // TikTok
            'tt_campaign_id', 'tt_adgroup_id', 'tt_ad_id'
        ];

        // Zbierz parametry z URL i zapisz w sessionStorage
        function captureTrackingParams() {
            const urlParams = new URLSearchParams(window.location.search);
            const stored = JSON.parse(sessionStorage.getItem('tracking_params') || '{}');

            TRACKING_PARAMS.forEach(param => {
                const value = urlParams.get(param);
                if (value) {
                    stored[param] = value;
                }
            });

            // Zapisz landing page tylko raz (pierwsza wizyta)
            if (!stored.landing_page) {
                stored.landing_page = window.location.href;
            }

            // Zapisz referrer tylko raz
            if (!stored.referrer && document.referrer) {
                stored.referrer = document.referrer;
            }

            sessionStorage.setItem('tracking_params', JSON.stringify(stored));
            return stored;
        }

        // Pobierz wszystkie zebrane parametry
        function getTrackingData() {
            const stored = JSON.parse(sessionStorage.getItem('tracking_params') || '{}');
            stored.user_agent = navigator.userAgent;
            return stored;
        }

        // Zbierz parametry przy zaadowaniu strony
        captureTrackingParams();

        // Handle form submission
        document.getElementById('email-form').addEventListener('submit', async function(e) {
            e.preventDefault();

            const email = document.getElementById('email-input').value;
            const domain = getEmailDomain(email);
            const provider = getProviderInfo(domain);

            // Save to Supabase - leads table (only email)
            try {
                const { data: leadResult, error: leadError } = await supabaseClient
                    .from('leads')
                    .insert([{ email: email }])
                    .select('id')
                    .single();

                if (leadError) {
                    console.error('Lead insert error:', leadError);
                } else if (leadResult) {
                    // Save tracking data to separate table
                    const trackingData = getTrackingData();
                    const { error: trackingError } = await supabaseClient
                        .from('lead_tracking')
                        .insert([{
                            lead_id: leadResult.id,
                            ...trackingData
                        }]);

                    if (trackingError) {
                        console.error('Tracking insert error:', trackingError);
                    }
                }
            } catch (err) {
                console.error('Error saving lead:', err);
            }

            // Hide chat, show thank you
            document.getElementById('chat-section').classList.add('hidden');
            document.getElementById('thankyou-section').classList.remove('hidden');

            // Start countdown
            startCountdown(provider);

            // Google Ads conversion tracking
            gtag('event', 'conversion', {'send_to': 'AW-17886093904/8_ykCOCF9OcbENDE4NBC'});

            // Meta Pixel Lead event
            fbq('track', 'Lead');

            // TikTok Pixel Lead event
            ttq.track('SubmitForm');
        });

        updateTimes();
    </script>

</body>
</html>
